<Window x:Class="DoleVisitorLogbook.Views.VisitorLogbookWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:DoleVisitorLogbook.Views"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        mc:Ignorable="d"
        Title="Visitor Logbook"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="#E8EAF6">

    <Window.Resources>
        <local:NullToBooleanConverter x:Key="NullToBooleanConverter"/>
    </Window.Resources>

    <Grid Background="#E8EAF6">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Compact Colorful Check-In Form -->
        <Border Grid.Row="0" 
                Background="White" 
                CornerRadius="8" 
                Margin="20,15,20,15"
                Padding="20,18"
                BorderBrush="#5C6BC0"
                BorderThickness="0,3,0,0">
            <Border.Effect>
                <DropShadowEffect Color="#9FA8DA" BlurRadius="12" 
                                  ShadowDepth="2" Opacity="0.35"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header with Icon and Time -->
                <Grid Grid.Row="0" Margin="0,0,0,12">
                    <StackPanel Orientation="Horizontal">
                        <Border Background="#5C6BC0" 
                                CornerRadius="6" 
                                Width="32" 
                                Height="32" 
                                Margin="0,0,10,0">
                            <TextBlock Text="✏️" 
                                       FontSize="16" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Quick Check-In" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   Foreground="#3F51B5"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" 
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center">
                        <Border Background="#E8EAF6"
                                CornerRadius="8"
                                Padding="12,6"
                                Margin="0,0,8,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🕐 " 
                                           FontSize="14"
                                           VerticalAlignment="Center"
                                           Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtCurrentTime"
                                           Text="00:00:00"
                                           FontSize="14"
                                           FontWeight="Bold"
                                           Foreground="#3F51B5"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#E8EAF6"
                                CornerRadius="8"
                                Padding="12,6">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📅 " 
                                           FontSize="14"
                                           VerticalAlignment="Center"
                                           Margin="0,0,5,0"/>
                                <TextBlock x:Name="txtCurrentDate"
                                           Text="January 1, 2025"
                                           FontSize="14"
                                           FontWeight="Bold"
                                           Foreground="#3F51B5"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- Form Fields -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1.5*"/>
                        <ColumnDefinition Width="0.8*"/>
                        <ColumnDefinition Width="0.9*"/>
                        <ColumnDefinition Width="1.2*"/>
                        <ColumnDefinition Width="1.3*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Name -->
                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <TextBlock Text="👤 Name *" 
                                   FontWeight="SemiBold" 
                                   FontSize="11"
                                   Foreground="#5C6BC0"
                                   Margin="0,0,0,5"/>
                        <TextBox x:Name="txtName" 
                                 Height="34" 
                                 FontSize="12"
                                 Padding="10,7"
                                 BorderBrush="#9FA8DA"
                                 BorderThickness="2"
                                 Margin="0,0,0,2">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Style.Triggers>
                                        <Trigger Property="IsFocused" Value="True">
                                            <Setter Property="BorderBrush" Value="#5C6BC0"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                        <TextBlock x:Name="txtNameError" 
                                   Text="Required" 
                                   Foreground="#E53935" 
                                   FontSize="10" 
                                   Visibility="Collapsed"/>
                    </StackPanel>

                    <!-- Gender -->
                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                        <TextBlock Text="⚥ Gender *" 
                                   FontWeight="SemiBold" 
                                   FontSize="11"
                                   Foreground="#5C6BC0"
                                   Margin="0,0,0,5"/>
                        <ComboBox x:Name="cbGender" 
                                  Height="34" 
                                  FontSize="12"
                                  Padding="10,7"
                                  BorderBrush="#9FA8DA"
                                  BorderThickness="2"
                                  Margin="0,0,0,2">
                            <ComboBoxItem Content="Male"/>
                            <ComboBoxItem Content="Female"/>
                            <ComboBoxItem Content="Other"/>
                        </ComboBox>
                        <TextBlock x:Name="txtGenderError" 
                                   Text="Required" 
                                   Foreground="#E53935" 
                                   FontSize="10" 
                                   Visibility="Collapsed"/>
                    </StackPanel>

                    <!-- Client Type -->
                    <StackPanel Grid.Column="2" Margin="0,0,10,0">
                        <TextBlock Text="🏷️ Type *" 
                                   FontWeight="SemiBold" 
                                   FontSize="11"
                                   Foreground="#5C6BC0"
                                   Margin="0,0,0,5"/>
                        <ComboBox x:Name="cbClientType" 
                                  Height="34" 
                                  FontSize="12"
                                  Padding="10,7"
                                  BorderBrush="#9FA8DA"
                                  BorderThickness="2"
                                  Margin="0,0,0,2">
                            <ComboBoxItem Content="Student"/>
                            <ComboBoxItem Content="Faculty"/>
                            <ComboBoxItem Content="Guest"/>
                        </ComboBox>
                        <TextBlock x:Name="txtClientTypeError" 
                                   Text="Required" 
                                   Foreground="#E53935" 
                                   FontSize="10" 
                                   Visibility="Collapsed"/>
                    </StackPanel>

                    <!-- Office/Institution -->
                    <StackPanel Grid.Column="3" Margin="0,0,10,0">
                        <TextBlock Text="🏢 Office *" 
                                   FontWeight="SemiBold" 
                                   FontSize="11"
                                   Foreground="#5C6BC0"
                                   Margin="0,0,0,5"/>
                        <TextBox x:Name="txtOffice" 
                                 Height="34" 
                                 FontSize="12"
                                 Padding="10,7"
                                 BorderBrush="#9FA8DA"
                                 BorderThickness="2"
                                 Margin="0,0,0,2">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Style.Triggers>
                                        <Trigger Property="IsFocused" Value="True">
                                            <Setter Property="BorderBrush" Value="#5C6BC0"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                        <TextBlock x:Name="txtOfficeError" 
                                   Text="Required" 
                                   Foreground="#E53935" 
                                   FontSize="10" 
                                   Visibility="Collapsed"/>
                    </StackPanel>

                    <!-- Purpose -->
                    <StackPanel Grid.Column="4" Margin="0,0,10,0">
                        <TextBlock Text="📝 Purpose *" 
                                   FontWeight="SemiBold" 
                                   FontSize="11"
                                   Foreground="#5C6BC0"
                                   Margin="0,0,0,5"/>
                        <TextBox x:Name="txtPurpose" 
                                 Height="34" 
                                 FontSize="12"
                                 Padding="10,7"
                                 BorderBrush="#9FA8DA"
                                 BorderThickness="2"
                                 Margin="0,0,0,2">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Style.Triggers>
                                        <Trigger Property="IsFocused" Value="True">
                                            <Setter Property="BorderBrush" Value="#5C6BC0"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                        <TextBlock x:Name="txtPurposeError" 
                                   Text="Required" 
                                   Foreground="#E53935" 
                                   FontSize="10" 
                                   Visibility="Collapsed"/>
                    </StackPanel>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Column="5" 
                                Orientation="Horizontal"
                                Margin="0,18,0,0">
                        <Button Content="🗑️ Clear"
                                Width="75"
                                Height="34"
                                Margin="0,0,8,0"
                                Background="White"
                                Foreground="#757575"
                                FontSize="11"
                                FontWeight="SemiBold"
                                BorderBrush="#BDBDBD"
                                BorderThickness="2"
                                Cursor="Hand"
                                Click="BtnClear_Click">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="5">
                                                    <ContentPresenter HorizontalAlignment="Center" 
                                                                      VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#F5F5F5"/>
                                            <Setter Property="BorderBrush" Value="#9E9E9E"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>

                        <Button x:Name="btnSave"
                                Content="✓ Check In"
                                Width="100"
                                Height="34"
                                Background="#5C6BC0"
                                Foreground="White"
                                FontSize="12"
                                FontWeight="Bold"
                                BorderThickness="0"
                                Cursor="Hand"
                                Click="BtnSave_Click">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="5">
                                                    <ContentPresenter HorizontalAlignment="Center" 
                                                                      VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#3F51B5"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter Property="Background" Value="#BDBDBD"/>
                                            <Setter Property="Cursor" Value="No"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- Emphasized Visitor Logbook with Vibrant Colors -->
        <Border Grid.Row="1" 
                Background="White" 
                CornerRadius="12" 
                Margin="20,0,20,20"
                Padding="30"
                BorderBrush="#7E57C2"
                BorderThickness="0,4,0,0">
            <Border.Effect>
                <DropShadowEffect Color="#512DA8" BlurRadius="20" 
                                  ShadowDepth="4" Opacity="0.25"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Logbook Header with Gradient Background -->
                <Border Grid.Row="0" 
                        Background="#673AB7"
                        CornerRadius="8"
                        Padding="20,15"
                        Margin="0,0,0,20">
                    <Border.Effect>
                        <DropShadowEffect Color="#512DA8" BlurRadius="8" 
                                          ShadowDepth="2" Opacity="0.3"/>
                    </Border.Effect>
                    <Grid>
                        <StackPanel Orientation="Horizontal">
                            <Border Background="White"
                                    CornerRadius="8"
                                    Width="40"
                                    Height="40"
                                    Margin="0,0,12,0">
                                <TextBlock Text="📋" 
                                           FontSize="22" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Visitor Logbook" 
                                           FontSize="26" 
                                           FontWeight="Bold" 
                                           Foreground="White"/>
                                <TextBlock Text="Track all library visitors in real-time"
                                           FontSize="12"
                                           Foreground="#D1C4E9"
                                           Margin="0,2,0,0"/>
                            </StackPanel>
                            <Border Background="#9575CD"
                                    CornerRadius="16"
                                    Padding="12,6"
                                    Margin="20,0,0,0"
                                    VerticalAlignment="Center">
                                <TextBlock x:Name="txtRecordCount"
                                           Text="0 records"
                                           FontSize="14"
                                           FontWeight="Bold"
                                           Foreground="White"/>
                            </Border>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" 
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center">
                            <Button Content="🔄 Refresh Data"
                                    Width="130"
                                    Height="38"
                                    Background="#9575CD"
                                    Foreground="White"
                                    FontSize="13"
                                    FontWeight="SemiBold"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnRefresh_Click">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center" 
                                                                          VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#7E57C2"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Enhanced DataGrid with Color Accents -->
                <Border BorderThickness="2"
                        BorderBrush="#B39DDB"
                        CornerRadius="8">
                    <DataGrid Grid.Row="1"
                              x:Name="dgVisitors"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              HeadersVisibility="Column"
                              GridLinesVisibility="Horizontal"
                              Background="White"
                              BorderThickness="0"
                              RowHeight="55"
                              CanUserResizeRows="False"
                              SelectionMode="Single"
                              AlternatingRowBackground="#F3E5F5"
                              FontSize="13">

                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Background" Value="#673AB7"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                                <Setter Property="FontSize" Value="13"/>
                                <Setter Property="Padding" Value="15,12"/>
                                <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                <Setter Property="BorderBrush" Value="#7E57C2"/>
                            </Style>
                        </DataGrid.ColumnHeaderStyle>

                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#EDE7F6"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding id}" Width="70">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#673AB7"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Name" Binding="{Binding name}" Width="*" MinWidth="180">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Gender" Binding="{Binding gender}" Width="90"/>
                            <DataGridTextColumn Header="Client Type" Binding="{Binding client_type}" Width="120">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="#5C6BC0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Office/Institution" Binding="{Binding office}" Width="*" />
                            <DataGridTextColumn Header="Purpose" Binding="{Binding purpose}" Width="*" />
                            <DataGridTextColumn Header="Time In" Binding="{Binding time_in_formatted}" Width="150">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="#43A047"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Time Out" Binding="{Binding time_out_formatted}" Width="150">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="#E53935"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTemplateColumn Header="Actions" Width="270">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <!-- Manual Checkout Time Input -->
                                            <TextBox Width="100"
                                                 x:Name="txtManualCheckout"
                                                 Tag="{Binding id}"
                                                 Height="34"
                                                 FontSize="12"
                                                 Padding="8"
                                                 BorderBrush="#B39DDB"
                                                 BorderThickness="2"
                                                 ToolTip="Enter time (HH:MM or HH:MM:SS)"
                                                 Margin="0,0,8,0"
                                                 IsEnabled="{Binding time_out, Converter={StaticResource NullToBooleanConverter}}">
                                                <TextBox.Style>
                                                    <Style TargetType="TextBox">
                                                        <Style.Triggers>
                                                            <Trigger Property="IsFocused" Value="True">
                                                                <Setter Property="BorderBrush" Value="#673AB7"/>
                                                            </Trigger>
                                                            <Trigger Property="IsEnabled" Value="False">
                                                                <Setter Property="Background" Value="#F5F5F5"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBox.Style>
                                            </TextBox>

                                            <!-- Checkout Button -->
                                            <Button Content="✓ Check Out"
                                                Background="#43A047"
                                                Foreground="White"
                                                Padding="14,8"
                                                FontSize="12"
                                                FontWeight="Bold"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                IsEnabled="{Binding time_out, Converter={StaticResource NullToBooleanConverter}}"
                                                Click="CheckOut_Click">
                                                <Button.Style>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="Button">
                                                                    <Border Background="{TemplateBinding Background}"
                                                                        CornerRadius="5">
                                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                                      VerticalAlignment="Center"/>
                                                                    </Border>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#388E3C"/>
                                                            </Trigger>
                                                            <Trigger Property="IsEnabled" Value="False">
                                                                <Setter Property="Background" Value="#BDBDBD"/>
                                                                <Setter Property="Foreground" Value="#757575"/>
                                                                <Setter Property="Cursor" Value="No"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</Window>