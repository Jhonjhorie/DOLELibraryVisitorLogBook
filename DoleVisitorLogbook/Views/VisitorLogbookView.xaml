<UserControl x:Class="DoleVisitorLogbook.Views.VisitorLogbookView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="600"
             d:DesignWidth="980">

    <Grid Margin="30" Background="#F5F5F5">
        <Border Background="White" CornerRadius="10" Padding="20" 
                HorizontalAlignment="Center" VerticalAlignment="Center"
                Width="900" Height="550">
            <StackPanel>

                <TextBlock Text="Visitor Logbook"
                           FontSize="28"
                           FontWeight="Bold"
                           Foreground="#333"
                           Margin="0,0,0,20"
                           HorizontalAlignment="Center"/>
                <Button Content="Refresh"
                            Width="90"
                            Height="25"
                            HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Margin="0,-40,0,10"
                            Background="#FF9800"
                            Foreground="White"
                            FontWeight="Bold"
                            Click="BtnRefresh_Click"/>
                <DataGrid x:Name="dgVisitors"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          AlternatingRowBackground="#F9F9F9"
                          RowBackground="White"
                          Foreground="Black"
                          GridLinesVisibility="None"
                          Height="400">

                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name" Binding="{Binding name}" Width="150"/>
                        <DataGridTextColumn Header="Gender" Binding="{Binding gender}" Width="80"/>
                        <DataGridTextColumn Header="Client Type" Binding="{Binding client_type}" Width="100"/>
                        <DataGridTextColumn Header="Office" Binding="{Binding office}" Width="150"/>
                        <DataGridTextColumn Header="Purpose" Binding="{Binding purpose}" Width="200"/>
                        <DataGridTextColumn Header="Time In" Binding="{Binding time_in}" Width="120"/>
                        <DataGridTextColumn Header="Time Out" Binding="{Binding time_out}" Width="120"/>

                        <!-- Check Out Button -->
                        <DataGridTemplateColumn Header="Action" Width="90">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="Check Out"
                                            Click="CheckOut_Click"
                                            Padding="5"
                                            Background="#4CAF50"
                                            Foreground="White"
                                            FontWeight="Bold"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                    </DataGrid.Columns>
                </DataGrid>

                <Button Content="Export to Excel"
                        Width="150"
                        Height="35"
                        HorizontalAlignment="Center"
                        Background="#2196F3"
                        Foreground="White"
                        FontWeight="Bold"
                        Margin="0,15,0,10"
                        Click="BtnExport_Click"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
